!function($){function position_jobs(offset){if($(window).width()>=880){var testimonials_h=$(".testimonials").height(),icta_h=$(".image-cta-wrap").height(),height_dif=testimonials_h-icta_h-offset;$("section.jobs").css("margin-top",-height_dif)}else $("section.jobs").css("margin-top","50px")}function calc_hero_video_width(){var new_h,new_w,$video_wraper=$(".hero__video"),vid_w=$video_wraper.width(),vid_h=$video_wraper.height(),w_w=$(window).width(),w_h=$(window).height(),top=0,left=0,vid_r=vid_w/vid_h,window_r=w_w/w_h;window_r>=vid_r?(new_h=w_h,new_w=new_h*vid_r,left=(w_w-new_w)/2):(new_w=w_w,new_h=new_w/vid_r,top=(w_h-new_h)/2),$video_wraper.css({height:new_h,width:new_w,top:top,left:left})}function onFinish(){$(".hero").removeClass("video-reveal")}function player_ready(player_id){var e="click";$play_trigger=$(".play-overlay"),froogaloop=$f(player_id),froogaloop.addEvent("play"),froogaloop.addEvent("finish",onFinish),froogaloop=$f(player_id),$play_trigger.on(e,function(){$(".hero").addClass("video-reveal"),froogaloop.api("play")})}function sticky_location_nav(nav){$(window).width()>=880?nav.stick_in_parent({parent:".locations-wrapper",offset_top:30,recalc_every:1}):nav.trigger("sticky_kit:detach")}function highlightLocationNav($groups,links_selector,$first){if($(window).width()>=880){var $currentGroup="",offsetPx=$groups.css("margin-bottom"),offset=parseInt(offsetPx,10);$groups.each(function(){var $group=$(this),myScrollTop=$group.offset().top,myHeight=$group.height();($group.visible(!0)||myScrollTop+myHeight>$(window).scrollTop())&&myScrollTop-offset<=$(window).scrollTop()&&($currentGroup=$group)}),""!==$currentGroup&&$currentGroup.length?($(links_selector).removeClass("active"),$(links_selector+"[href='#"+$currentGroup.attr("id")+"'] ").addClass("active")):($(links_selector).removeClass("active"),$first.addClass("active"))}}function set_award_slides_heights(){var fwh=$(".awards-slider .flex-viewport").height();$(".awards-slider .award").height(fwh)}var jm={common:{init:function(){var e="click";$(".nav-drop").hide().removeClass("initial"),$(".nav-trigger").on(e,function(){$("body").hasClass("nav-opened")?$(".nav-drop").slideToggle("fast",function(){$("body").removeClass("nav-opened")}):($("body").addClass("nav-opened"),$(".nav-drop").slideToggle())});var $pck_container=$(".pck-container");if($($pck_container).imagesLoaded(function(){$pck_container.find(".box-article").removeClass("hide"),$pck_container.packery({gutter:0,itemSelector:".box-article"})}),$(".back-to-top").on(e,function(e){return e.preventDefault(),$.smoothScroll(0),!1}),$(".scroll-to-content").on(e,function(){var $target=$(this).closest(".hero").next();return $.smoothScroll({offset:$target.offset().top,speed:300}),!1}),$(".hero-slider").flexslider({animation:"slide",controlNav:!1,animationLoop:!1}),$(".video-wrapper").fitVids(),$(".main").fitVids(),calc_hero_video_width(),$(".play-overlay").hover(function(){$(".play-video").toggleClass("hovered")}),$("#vplayer").length){var $video_frame=$("#vplayer")[0],player=$f($video_frame);player.addEvent("ready",player_ready)}$("#youkuplayer").length&&($play_trigger=$(".play-overlay"),$play_trigger.on(e,function(){$(".hero").addClass("video-reveal")})),$("input, textarea").placeholder(),$(".share__trigger").on(e,function(){$(this).parent().toggleClass("share-opened")}),$(".info-boxes").equalize("outerHeight"),$(".js-reveal-drawer").on(e,function(){$(".wrapper").toggleClass("is-drawer-opened")}),$(window).smartresize(function(){calc_hero_video_width(),$(".info-boxes").equalize("outerHeight")})}},home:{init:function(){$(".container-home .himg-item").hover(function(){$(this).removeClass("grey");var highlight=".h-article__title."+$(this).data("highlight");$(highlight).toggleClass("highlight")})}},page_template_page_culture_php:{init:function(){$(".image-cta-wrap").imagesLoaded(function(){position_jobs(0)});var $container=$(".jobs-list");$container.packery({itemSelector:".box-content",columnWidth:".gutter-sizer"}),$($container).imagesLoaded(function(){$container.packery()}),$(window).smartresize(function(){position_jobs(30)})}},page_template_page_about_php:{init:function(){$(".awards-slider").flexslider({animation:"slide",controlNav:!1,start:function(){set_award_slides_heights()}}),$("#people").flexslider({animation:"slide",controlNav:!1,animationLoop:!1,slideshow:!1,itemWidth:83,itemMargin:0,asNavFor:"#quotes"}),$("#quotes").flexslider({animation:"slide",controlNav:!1,animationLoop:!0,slideshow:!0,sync:"#people"}),$(window).smartresize(function(){set_award_slides_heights()})}},page_template_page_contact_php:{init:function(){var e="click",$nav=$(".locations-navigation"),$links=$nav.find(".region-nav");sticky_location_nav($nav),$links.on(e,function(){$links.removeClass("active"),$(this).addClass("active")}),$(window).smartresize(function(){sticky_location_nav($nav)});var $groups=$(".locations-group"),links_selector=".locations-navigation .region-nav",$first_link=$(".locations-navigation li:first-child a");$(window).scroll(function(){highlightLocationNav($groups,links_selector,$first_link)})}},single_post:{init:function(){var $related=$(".yarpp-related");$(".yarpp-related").remove(),$(".more-wrap").append($related)}}},UTIL={fire:function(func,funcname,args){var namespace=jm;funcname=void 0===funcname?"init":funcname,""!==func&&namespace[func]&&"function"==typeof namespace[func][funcname]&&namespace[func][funcname](args)},loadEvents:function(){UTIL.fire("common"),$.each(document.body.className.replace(/-/g,"_").split(/\s+/),function(i,classnm){UTIL.fire(classnm)})}};$(document).ready(UTIL.loadEvents),Modernizr.touch&&FastClick.attach(document.body)}(jQuery),function(){function preventDefault(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function keydown(e){for(var i=keys.length;i--;)if(e.keyCode===keys[i])return void preventDefault(e)}function touchmove(e){preventDefault(e)}function wheel(){}function disable_scroll(){window.onmousewheel=document.onmousewheel=wheel,document.onkeydown=keydown,document.body.ontouchmove=touchmove}function enable_scroll(){window.onmousewheel=document.onmousewheel=document.onkeydown=document.body.ontouchmove=null}function scrollY(){return window.pageYOffset||docElem.scrollTop}function scrollPage(){if(scrollVal=scrollY(),noscroll&&!ie){if(0>scrollVal)return!1;window.scrollTo(0,0)}return classie.has(container,"notrans")?(classie.remove(container,"notrans"),!1):isAnimating?!1:void(0>=scrollVal&&isRevealed?toggle(0):scrollVal>0&&!isRevealed&&toggle(1))}function toggle(reveal){isAnimating=!0,reveal?classie.add(container,"modify"):(noscroll=!0,disable_scroll(),classie.remove(container,"modify")),setTimeout(function(){isRevealed=!isRevealed,isAnimating=!1,reveal&&(noscroll=!1,enable_scroll())},1200)}var scrollVal,isRevealed,noscroll,isAnimating,ie=function(){var undef,rv=-1,ua=window.navigator.userAgent,msie=ua.indexOf("MSIE "),trident=ua.indexOf("Trident/");if(msie>0)rv=parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);else if(trident>0){var rvNum=ua.indexOf("rv:");rv=parseInt(ua.substring(rvNum+3,ua.indexOf(".",rvNum)),10)}return rv>-1?rv:undef}(),keys=[32,37,38,39,40],docElem=window.document.documentElement,container=document.getElementById("intro-effect-container");if(container&&(trigger=container.querySelector(".content-reveal-trigger")),container){var ehtml=document.getElementsByTagName("html")[0];if(classie.has(ehtml,"no-csstransitions"))trigger.addEventListener("click",function(){jQuery("html").animate({scrollTop:jQuery(".case-study__content-wrap").offset().top},500)});else{var pageScroll=scrollY();noscroll=0===pageScroll,disable_scroll(),pageScroll&&(isRevealed=!0,classie.add(container,"notrans"),classie.add(container,"modify")),window.addEventListener("scroll",scrollPage),trigger.addEventListener("click",function(){toggle("reveal")})}}}(),function($){function setTopClass($header){0===lastScrollTop?$header.removeClass("headder--not-top").addClass("headder--top").removeClass("header--pinned"):$header.removeClass("headder--top").addClass("headder--not-top")}function hasScrolled(){var st=$(this).scrollTop();Math.abs(lastScrollTop-st)<=delta||(st>lastScrollTop?$header.removeClass("header--pinned").addClass("header--unpinned"):st+$(window).height()<$(document).height()&&$header.removeClass("header--unpinned").addClass("header--pinned"),lastScrollTop=st)}{var didScroll,lastScrollTop=0,delta=5,$header=$(".js-header-sticky");$header.outerHeight()}setTopClass($header),$(window).scroll(function(){didScroll=!0}),setInterval(function(){didScroll&&(hasScrolled(),setTopClass($header),didScroll=!1)},100)}(jQuery);